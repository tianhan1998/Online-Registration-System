<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <body>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">
    <!-- Bootstrap CSS-->
    <link rel="stylesheet" href="css/bootstrap.css">
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">
    <!-- Google fonts - Popppins for copy-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Poppins:300,400,800">
    <!-- orion icons-->
    <link rel="stylesheet" href="css/orionicons.css">
    <!-- theme stylesheet-->
    <link rel="stylesheet" href="css/style.default.css" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
    <link rel="stylesheet" href="css/custom.css">
    <!-- Favicon-->
    <link rel="shortcut icon" href="img/favicon.png?3">
    <!-- Tweaks for older IEs--><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
  </head>
    <div class="page-holder d-flex align-items-center">
      <div class="container">
        <div class="row align-items-center py-5">
          <div class="col-5 col-lg-7 mx-auto mb-5 mb-lg-0">
            <div class="pr-lg-5"><img src="img/illustration1.svg" alt="" class="img-fluid"></div>
          </div>
          <div class="col-lg-5 px-lg-4">
            <h1 class="text-base text-primary text-uppercase mb-4">安阳师范学院</h1>
            <h2 class="mb-4">报名系统</h2>
            <p class="text-muted">此系统是一个非常强的系统</p>
            <form id="loginForm" action="index.html" class="mt-4">
            	<div id="change">
	              <div class="form-group mb-4">
	                <input type="text" name="memId" id="memId" placeholder="学号" class="form-control border-0 shadow form-control-lg">
	              </div>
	              <div class="form-group mb-4">
	                <input type="text" name="memName" placeholder="姓名" class="form-control border-0 shadow form-control-lg text-violet">
	              </div>
				  <select name="memSex" class="form-control border-0 shadow form-control-lg text-violet">
				      <option value="F">男</option>
				      <option value="M">女</option>
				  </select>
	              <div class="form-group mb-4">
	                <input type="text" name="memEmail" placeholder="邮箱" class="form-control border-0 shadow form-control-lg text-violet">
	              </div>
	               <div class="form-group mb-4">
	                <input type="password" name="memPassowrd" placeholder="密码" class="form-control border-0 shadow form-control-lg text-violet">
	              </div>
	              <div class="form-group mb-4">
	                <input type="password" name="memPassowrd2" placeholder="确认密码" class="form-control border-0 shadow form-control-lg text-violet">
	              </div>
	            </div>
              <button type="button" class="btn btn-primary shadow px-5" id="register">注册</button>
              <button type="button" class="btn btn-primary shadow px-5 ml-5" id="login">去登录</button>
            </form>
          </div>
        </div>
        <p class="mt-5 mb-0 text-gray-400 text-center">Copyright &copy; 2019.Company name All rights reserved.More Templates <a href="http://www.aynu.edu.cn/" target="_blank" title="jq22">aynu</a>& Your company</p>
        <!-- Please do not remove the backlink to us unless you support further theme's development at https://bootstrapious.com/donate. It is part of the license conditions. Thank you for understanding :)                 -->
      </div>
    </div>
    <!-- JavaScript files-->
    <script src="js/jquery.js"></script>
    <script src="vendor/popper.js/umd/popper.min.js"> </script>
    <script src="js/bootstrap.js"></script>
    <script src="vendor/jquery.cookie/jquery.cookie.js"> </script>
    <script src="https://cdn.bootcss.com/Chart.js/2.7.2/Chart.min.js"></script>
    <script src="js/js.cookie.min.js"></script>
    <script src="js/front.js"></script>
    <script src="js/tishi.js"></script>
    <script>
		//失去焦点的时候验证学号是否已经注册
    	$(document).ready(function() {
			$("#memId").blur(function(){
				var username=$("input[name='memId']").val();
				if(username.length>0) {
                    $.ajax({
                        type: "get",
                        url: "./signUp",
                        data: {"memId": username},//TODO 修了BUG
                        success: function (data) {
                            console.log("账号没有重复！" + data);
							$.MsgBox.Alert("提示",data.msg);
                            // window.location.href="/ORS/tables.html";//TODO 重复不要跳转，修改页面元素提醒
                        },
                        error: function (data) {
                            console.log("提示！" + data.msg);
							$.MsgBox.Alert("提示",data.msg);
                        },
                        async: true
                    });
                }
			});
    		var lo_html=$("#change").html();
			  $("#login").click(function(){
		  		//var htm='<div class="form-group mb-4"><input type="text" name="username" placeholder="用户名或邮箱" class="form-control border-0 shadow form-control-lg"></div><div class="form-group mb-4"><input type="password" name="passowrd" placeholder="密码" class="form-control border-0 shadow form-control-lg text-violet"></div><div class="form-group mb-4"><input type="password" name="check_passowrd" placeholder="确认密码" class="form-control border-0 shadow form-control-lg text-violet"></div>';
	    		//$("#change").html(htm);
	    		window.location.href="login";
		    });
		    $("#register").click(function(){
		    	//$("#change").html(lo_html);
		    	var username=$("input[name='memId']").val();
		    	var password=$("input[name='memPassowrd']").val();
		    	var check_password=$("input[name='memPassowrd2']").val();
		    	
		    	if(username.length<8){
		    		$.MsgBox.Alert("提示", "学号长度不少于8位！");
		    		return;
		    	}
		    	if(password.length<6){
		    		$.MsgBox.Alert("提示", "密码长度不少于6位！");
		    		return;
		    	}
		    	if(password!=check_password){
		    		$.MsgBox.Alert("提示", "输入密码不一致！");
		    		return;
		    	}
		    	//ajax注册
		    	
				
		    	$.ajax({
                    type:"post",
                    url:"./signUp",
                    data:$('#loginForm').serialize(),
                    success:function(data){
						if(data.msg=="200"){
							console.log("注册成功！"+data);
							window.location.href="/ORS/tables";//TODO 注册成功进login控制器
						}
                    },
                    error:function(data){
                        console.log("注册失败！"+data);
                    },
		    		async:true
		    	});
		    	
		    });
			});
    </script>
  </body>
</html>